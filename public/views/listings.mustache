{{> header}}

<div class="container my-5">

  <!-- ================= SEARCH PANEL ================= -->
  <h2 class="mb-4 text-center fw-semibold">Search Listings</h2>

  <form action="/search" method="GET" class="card shadow-sm p-4 mb-5 search-card">
    <div class="row g-3">

      <div class="col-md-4">
        <input
          type="text"
          name="city"
          class="form-control"
          placeholder="City"
          value="{{filters.city}}">
      </div>

      <div class="col-md-4">
        <input
          type="text"
          name="area"
          class="form-control"
          placeholder="Area / Neighbourhood"
          value="{{filters.area}}">
      </div>

      <div class="col-md-4">
        <input
          type="text"
          name="postcode"
          class="form-control"
          placeholder="Postcode"
          value="{{filters.postcode}}">
      </div>

      <div class="col-md-3">
        <input
          type="number"
          name="minPrice"
          class="form-control"
          placeholder="Min Price (Â£)"
          value="{{filters.minPrice}}">
      </div>

      <div class="col-md-3">
        <input
          type="number"
          name="maxPrice"
          class="form-control"
          placeholder="Max Price (Â£)"
          value="{{filters.maxPrice}}">
      </div>

      <div class="col-md-6 d-grid">
        <button type="submit" class="btn btn-primary btn-lg">
          ğŸ” Search Listings
        </button>
      </div>

    </div>
  </form>
  <!-- ================= END SEARCH PANEL ================= -->


  <!-- ================= LISTINGS GRID ================= -->
  <div class="row row-cols-1 row-cols-md-3 g-4">

    {{#listings}}
    <div class="col">
      <div class="card listing-card h-100">

        <img
          src="{{imageUrl}}"
          class="card-img-top listing-img"
          alt="{{title}}">

        <div class="card-body d-flex flex-column">
          <h5 class="card-title">{{title}}</h5>

          <p class="text-muted small mb-2">
            {{location}}{{#area}} Â· {{area}}{{/area}}
          </p>

          <p class="price mb-3">Â£{{price}}</p>

          <div class="mt-auto d-flex justify-content-between align-items-center">
            <a href="/listing/{{_id}}" class="btn btn-outline-primary btn-sm">
              View â†’
            </a>

            {{#isTenant}}

              {{^isSaved}}
              <form method="POST" action="/listing/{{_id}}/save">
                <input type="hidden" name="action" value="save">
                <button type="submit" class="btn btn-outline-danger btn-sm">
                  <i class="bi bi-heart"></i>
                </button>
              </form>
              {{/isSaved}}

              {{#isSaved}}
              <form method="POST" action="/listing/{{_id}}/save">
                <input type="hidden" name="action" value="unsave">
                <button type="submit" class="btn btn-danger btn-sm">
                  <i class="bi bi-heart-fill"></i>
                </button>
              </form>
              {{/isSaved}}

            {{/isTenant}}
          </div>

        </div>
      </div>
    </div>
    {{/listings}}

    {{^listings}}
      <p class="text-muted text-center fs-5 mt-4">
        ğŸ˜• No listings found.
      </p>
    {{/listings}}

  </div>
  <!-- ================= END LISTINGS GRID ================= -->

</div>

{{> footer}}

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
